<!--
 Copyright (c) 2015 Andrea SonnY. All rights reserved.
 This code may only be used under the MIT license found at https://github.com/andreasonny83/polymer-cookie/blob/master/LICENSE
 -->
<link rel="import" href="../polymer/polymer.html">

<!--
Storing cookies using a web components is the best way to use cookie in a Polyper project

##### Example
		<polymer-cookie id="lq_cookie" name="sonny" time=1 format="m">test cookie</polymer-cookie>

	<polymer-cookie
		name="testCookie"
		time=30
		format="m">
			HelloWorld
	</polymer-cookie>

This will create a cookie named testCookie that will expires after 30 days

@element polymer-cookie
@homepage https://github.com/andreasonny83/polymer-cookie
-->

<script>

Polymer({
	is: 'polymer-cookie',

	properties: {
		/**
		 * [name]
		 * Used to set the cookie name
		 * @type [String]
		 */
		name: {
			type: String,
			value: 'newCookie'
		},

		/**
		 * [time]
		 * This is an array containing the expiration time of the cookie
		 * @type [Number]
		 *       Default: 1
		 *        0 : Expiration time is set in the past
		 *        -1: Never expires
		 */
		time: {
			type: Number,
			value: 1
		},

		/**
		 * [format]
		 * This is an array containing the expiration format of the cookie
		 * @type [String] optional
		 *       Default :'d'
		 *       's' : seconds
		 *       'm' : minutes
		 *       'h' : hours
		 *       'd' : days
		 */ 
		format: {
			type: String,
			value: 'd'
		}
	},

	createCookie: function() {
		var expire_type = this.format,
			expire_time = this.time,
			value       = this.textContent,
			date        = new Date();

		// if we don't have set any value for the cookie,
		// set a default one
		if ( value === undefined || value === null || value === '' ) {
			value = 'hello world';
		}

		switch( expire_type ) {
			case 'd':
				date.setTime( date.getTime() + ( expire_time * 1000 * 24 * 60 * 60 ) );
				break;
			case 'h':
				date.setTime( date.getTime() + ( expire_time * 1000 * 60 * 60 ) );
				break;
			case 'm':
				date.setTime( date.getTime() + ( expire_time * 1000 * 60 ) );
				break;
			default:
				date.setTime( date.getTime() + ( expire_time * 1000 ) );
				break;
		}

		var output = this.name + "=" + value + "; expires=" + date.toGMTString() + "; path=/";

		document.cookie = output;
	},

	eraseCookie: function( name ) {
		var output = this.name + "=; expires=-1;";

		document.cookie( output );
	}

});
</script>